"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[268],{1211:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var n=s(6540),a=s(535);const o={chatContainer:"chatContainer_Nb5C",messagesContainer:"messagesContainer_am9Z",message:"message_O2Nj",user:"user_qHKE",assistant:"assistant_Bil_",inputContainer:"inputContainer_GD0z",chatInput:"chatInput__sTm",sendButton:"sendButton_Bxz1"};var r=s(4848);const i=()=>{const[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)([]),i=(0,n.useRef)(null);(0,n.useEffect)(()=>{i.current?.scrollIntoView({behavior:"smooth"})},[s]);const c=async()=>{if(""===e.trim())return;const n={role:"user",content:e};a(e=>[...e,n]),t("");try{const t=await fetch("http://localhost:8000/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,history:s})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.body?.getReader();if(!n)throw new Error("Failed to get response reader");let o="";for(a(e=>[...e,{role:"assistant",content:""}]);;){const{done:e,value:t}=await n.read();if(e)break;const s=(new TextDecoder).decode(t);o+=s,a(e=>{const t=e[e.length-1];return"assistant"===t.role?[...e.slice(0,-1),{...t,content:o}]:e})}}catch(o){console.error("Error sending message:",o),a(e=>[...e,{role:"assistant",content:`Error: ${o.message}`}])}};return(0,r.jsxs)("div",{className:o.chatContainer,children:[(0,r.jsxs)("div",{className:o.messagesContainer,children:[s.map((e,t)=>(0,r.jsx)("div",{className:`${o.message} ${o[e.role]}`,children:e.content},t)),(0,r.jsx)("div",{ref:i})]}),(0,r.jsxs)("div",{className:o.inputContainer,children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"===e.key&&c()},placeholder:"Ask me a question...",className:o.chatInput}),(0,r.jsx)("button",{onClick:c,className:o.sendButton,children:"Send"})]})]})};const c=function(){return(0,r.jsx)(a.A,{title:"Chat",description:"Chat with the AI assistant about the book.",children:(0,r.jsx)("main",{children:(0,r.jsx)(i,{})})})}}}]);